# コーディング規約

このディレクトリには各言語のコーディング規約が格納されています。

## 共通原則

すべての言語に共通する基本原則です。

### 1. 読みやすさ優先
- シンプルで理解しやすいコードを書く
- 複雑なロジックには説明コメントを追加
- 適切な命名で意図を明確にする

### 2. YAGNI (You Aren't Gonna Need It)
- 現時点で必要な機能のみを実装
- 将来の拡張を見越した過度な抽象化を避ける
- 必要になったときに追加する

### 3. DRY (Don't Repeat Yourself)
- 重複コードを避ける
- ただし、無理な共通化はしない
- 3回以上繰り返す場合に共通化を検討

### 4. 小さく保つ
- 関数は1つの責任のみを持つ
- ファイルサイズは適切に保つ
- クラス・モジュールの責任を明確にする

## 言語別規約

プロジェクトで使用する言語の規約を参照してください。

- [TypeScript](./typescript.md)
- [Python](./python.md)
- [Go](./go.md)
- [Rust](./rust.md)
- [Java](./java.md)

## 命名規則

### 共通ルール
- 意味のある名前を使用
- 略語は一般的なもののみ使用
- 単一文字の変数名は避ける（ループカウンタを除く）

### ケース
各言語の慣習に従います:

| 言語 | 変数/関数 | クラス/型 | 定数 | ファイル |
|------|----------|----------|------|---------|
| TypeScript | camelCase | PascalCase | UPPER_SNAKE_CASE | kebab-case |
| Python | snake_case | PascalCase | UPPER_SNAKE_CASE | snake_case |
| Go | camelCase | PascalCase | UPPER_SNAKE_CASE | snake_case |
| Rust | snake_case | PascalCase | UPPER_SNAKE_CASE | snake_case |
| Java | camelCase | PascalCase | UPPER_SNAKE_CASE | PascalCase |

## コメント

### 書くべきコメント
- 複雑なロジックの説明
- なぜそのような実装にしたかの理由
- TODO/FIXME
- 外部ライブラリの使用方法の補足

### 書かないコメント
- コードを読めば分かること
- 古い実装の履歴（Gitで管理）
- コメントアウトされたコード

**❌ 悪い例:**
```typescript
// ユーザー名を取得する
const userName = user.name
```

**✅ 良い例:**
```typescript
// APIのバグでnameがnullになる場合があるため、デフォルト値を設定
const userName = user.name ?? 'Anonymous'
```

## エラーハンドリング

### 基本方針
- 予期できるエラーは適切に処理
- 予期しないエラーは上位に伝播
- エラーメッセージは具体的に

### ログ出力
- エラー発生時は必ずログを出力
- スタックトレースを含める
- 個人情報をログに出力しない

## テスト

### テストコード規約
- テストは読みやすく保つ
- 1テスト1アサーション（可能な限り）
- テスト名は何をテストするか明確に

**例:**
```typescript
describe('User', () => {
  describe('login', () => {
    test('正しい認証情報でログインできる', () => {
      // ...
    })

    test('誤ったパスワードでログインできない', () => {
      // ...
    })
  })
})
```

## セキュリティ

### 基本原則
- 入力は常に検証する
- 出力は常にエスケープする
- 機密情報をハードコードしない
- 最小権限の原則に従う

詳細は `docs/rules/security.md` を参照してください。

## パフォーマンス

### 基本方針
- まず動くコードを書く
- 測定してから最適化する
- 明らかなアンチパターンは避ける

### 避けるべきパターン
- N+1クエリ
- 不要なループのネスト
- 過度なメモリ使用

## フォーマット

### 自動フォーマッタを使用
各言語の標準的なフォーマッタを使用します:

- TypeScript/JavaScript: Prettier
- Python: Black
- Go: gofmt
- Rust: rustfmt
- Java: google-java-format

### エディタ設定
- インデント: スペース（言語により2 or 4）
- 改行: LF
- 文字コード: UTF-8
- 末尾の空白: 削除

## バージョン管理

### コミット
- 1コミット1機能
- 明確なコミットメッセージ
- 詳細は `docs/rules/git-workflow.md` を参照

### ブランチ
- 機能ごとにブランチを作成
- main/master は常にデプロイ可能な状態を保つ

## レビュー

コードレビューは `.claude/reviews/guidelines.md` を参照してください。

## 例外

規約には例外があることを認識します。
ただし、例外を適用する場合は以下を守ってください:

1. なぜ規約に従わないかをコメントで説明
2. チームで合意を得る
3. 本当に必要な場合のみ適用

## 規約の更新

規約は定期的に見直し、更新します。
提案がある場合は、ADR (Architecture Decision Record) として記録してください。

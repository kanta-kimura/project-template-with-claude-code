# タスク細分化ルール

実装計画を並列実行可能なタスクに細分化するためのガイドラインです。

## 基本原則

### 1. 独立性の確保
各タスクは可能な限り他のタスクから独立して実装できるように分割します。

**良い例:**
- タスクA: ユーザーモデルの実装
- タスクB: ログ機能の実装（タスクAとは独立）

**悪い例:**
- タスクA: データベース設計とAPI実装（分割すべき）
- タスクB: APIのテストとデプロイ設定（タスクAに依存しすぎ）

### 2. 適切な粒度
1タスクは1〜2日で完了できる規模を目安とします。

**粒度の目安:**
- ✅ 適切: 1つの機能、1つのAPI、1つのコンポーネント
- ❌ 大きすぎ: システム全体、モジュール全体
- ❌ 小さすぎ: 1つの関数、変数名の変更

### 3. テスト可能性
各タスクは単独でテスト可能な単位に分割します。

## 細分化手順

### Step 1: 機能を洗い出す
実装計画から主要機能をリストアップします。

### Step 2: 依存関係を特定
機能間の依存関係を明確にします。

```
例:
認証システム
├── データベーススキーマ設計 (依存なし)
├── ユーザーモデル (スキーマに依存)
├── 認証ミドルウェア (ユーザーモデルに依存)
└── ログイン画面 (認証ミドルウェアに依存)
```

### Step 3: 並列実行可能なグループに分ける
依存関係のないタスクをグループ化します。

```
グループ1 (並列実行可能):
- データベーススキーマ設計
- ログ機能実装
- エラーハンドリング実装

グループ2 (グループ1完了後):
- ユーザーモデル実装
- 設定ファイル管理

グループ3 (グループ2完了後):
- 認証ミドルウェア実装
```

### Step 4: タスクファイルを作成
`templates/task.md` をコピーして各タスクの詳細を記述します。

## タスク命名規則

```
TASK-[連番]-[機能名]-[詳細]

例:
- TASK-001-auth-database-schema
- TASK-002-auth-user-model
- TASK-003-logging-setup
```

## チェックリスト

タスク細分化時に以下を確認してください:

- [ ] 各タスクは明確な成果物を持つ
- [ ] タスク間の依存関係が `dependencies.yaml` に記載されている
- [ ] 各タスクは1〜2日で完了可能
- [ ] 並列実行可能なタスクが複数ある
- [ ] 各タスクに必要なコンテキスト情報が `.claude/context/` にある
- [ ] テスト方法が明確

## 注意事項

- 依存関係が多すぎる場合は、設計を見直す
- 共通部分は `.claude/context/` に抽出する
- インターフェースを先に定義すると並列開発しやすい
- 不確実性が高い部分は先に調査タスクとして分離する
